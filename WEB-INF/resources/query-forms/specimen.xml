#macro(getMessage $code)$messageSource.getMessage($code, null, $locale)#end

<form>
  <view>
    <name>Specimen</name>
    <caption>#getMessage("specimen")</caption>
    <table>CATISSUE_SPECIMEN</table>
    <hierarchyTable>CATISSUE_SPECIMEN_HIERARCHY</hierarchyTable>
    <hierarchyAncestorColumn>ANCESTOR_ID</hierarchyAncestorColumn>
    <hierarchyDescendentColumn>DESCENDENT_ID</hierarchyDescendentColumn>
    <activeCondition>ACTIVITY_STATUS != 'Disabled'</activeCondition>
    
    <row>
      <numberField>
        <name>id</name>
        <udn>id</udn>
        <caption>#getMessage("specimen_identifier")</caption>
        <column>IDENTIFIER</column>
        <recordUrl>#/object-state-params-resolver?stateName=specimen-detail.overview&amp;objectName=specimen&amp;key=id&amp;value={{$value}}</recordUrl>
      </numberField>
    </row>

    <row>
      <dropDown>
        <name>lineage</name>
        <udn>lineage</udn>
        <caption>#getMessage("specimen_lineage")</caption>
        <column>LINEAGE</column>
        <options>
          <option><value>New</value></option>
          <option><value>Derived</value></option>
          <option><value>Aliquot</value></option>
        </options>
      </dropDown>
    </row>

    <row>
      <textField>
        <name>label</name>
        <udn>label</udn>
        <caption>#getMessage("specimen_label")</caption>
        <column>LABEL</column>
        <recordUrl>#/object-state-params-resolver?stateName=specimen-detail.overview&amp;objectName=specimen&amp;key=id&amp;value={{$specimenId}}</recordUrl>
      </textField>
    </row>

    <row>
      <subForm>
        <name>parentSpecimen</name>
        <udn>parentSpecimen</udn>
        <caption>#getMessage("specimen_parent_specimen")</caption>
        <table>CATISSUE_SPECIMEN</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>PARENT_SPECIMEN_ID</parentKey>
        <row>
          <textField>
            <name>parentId</name>
            <udn>parentId</udn>
            <caption>#getMessage("specimen_parent_specimen_id")</caption>
            <column>IDENTIFIER</column>
            <recordUrl>#/object-state-params-resolver?stateName=specimen-detail.overview&amp;objectName=specimen&amp;key=id&amp;value={{$value}}</recordUrl>
          </textField>
          <textField>
            <name>parentLabel</name>
            <udn>parentLabel</udn>
            <caption>#getMessage("specimen_parent_specimen_label")</caption>
            <column>LABEL</column>
            <recordUrl>#/object-state-params-resolver?stateName=specimen-detail.overview&amp;objectName=specimen&amp;key=id&amp;value={{$parentSpecimenId}}</recordUrl>
          </textField>
        </row>
      </subForm>
    </row>

    <row>
      <textField>
        <name>barcode</name>
        <udn>barcode</udn>
        <caption>#getMessage("specimen_barcode")</caption>
        <column>BARCODE</column>
      </textField>
    </row>

    <row>
      <dropDown>
        <name>class</name>
        <udn>class</udn>
        <caption>#getMessage("specimen_class")</caption>
        <column>SPECIMEN_CLASS</column>
        <options>
          <sql>
            select
              value
            from
              catissue_permissible_value
            where
              public_id = 'specimen_type' and
              parent_identifier is null
            order by value
          </sql>
        </options>
      </dropDown>
    </row>

    <row>
      <dropDown>
        <name>type</name>
        <udn>type</udn>
        <caption>#getMessage("specimen_type")</caption>
        <column>SPECIMEN_TYPE</column>
        <options>
          <sql>
            select
              distinct value
            from
              catissue_permissible_value
            where
              public_id = 'specimen_type' and
              parent_identifier is not null
            order by value
          </sql>
        </options>
      </dropDown>
    </row>

    <row>
      <dropDown>
        <name>tissueSite</name>
        <udn>tissueSite</udn>
        <caption>#getMessage("specimen_anatomic_site")</caption>
        <column>TISSUE_SITE</column>
        <options>
          <sql>
            select 
              pv.value 
            from 
              catissue_permissible_value pv 
            where 
              pv.public_id = 'anatomic_site'
            order by
              value
          </sql>
        </options>
      </dropDown>
    </row>

    <row>
      <dropDown>
        <name>tissueSide</name>
        <udn>tissueSide</udn>
        <caption>#getMessage("specimen_laterality")</caption>
        <column>TISSUE_SIDE</column>
        <options>
          <sql>select value from catissue_permissible_value where public_id = 'laterality' order by value</sql>
        </options>
      </dropDown>
    </row>

    <row>
      <dropDown>
        <name>pathologicalStatus</name>
        <udn>pathologicalStatus</udn>
        <caption>#getMessage("specimen_pathological_status")</caption>
        <column>PATHOLOGICAL_STATUS</column>
        <options>
          <sql>select value from catissue_permissible_value where public_id = 'pathology_status' order by value</sql>
        </options>
      </dropDown>
    </row>

    <row>
      <datePicker>
        <name>createdOn</name>
        <udn>createdOn</udn>
        <caption>#getMessage("specimen_created_on")</caption>
        <column>CREATED_ON</column>
      </datePicker>
    </row>

    <row>
      <numberField>
        <name>initialQty</name>
        <udn>initialQty</udn>
        <caption>#getMessage("specimen_initial_quantity")</caption>
        <column>INITIAL_QUANTITY</column>
        <noOfDigitsAfterDecimal>2</noOfDigitsAfterDecimal>
      </numberField>
    </row>

    <row>
      <numberField>
        <name>availableQty</name>
        <udn>availableQty</udn>
        <caption>#getMessage("specimen_available_quantity")</caption>
        <column>AVAILABLE_QUANTITY</column>
        <noOfDigitsAfterDecimal>2</noOfDigitsAfterDecimal>
      </numberField>
    </row>

    <row>
      <numberField>
        <name>concentration</name>
        <udn>concentration</udn>
        <caption>#getMessage("specimen_concentration")</caption>
        <column>CONCENTRATION</column>
        <noOfDigitsAfterDecimal>2</noOfDigitsAfterDecimal>
      </numberField>
    </row>

    <row>
      <dropDown>
        <name>collectionStatus</name>
        <udn>collectionStatus</udn>
        <caption>#getMessage("specimen_collection_status")</caption>
        <column>COLLECTION_STATUS</column>
        <options>
          <option><value>Pending</value></option>
          <option><value>Collected</value></option>
          <option><value>Not Collected</value></option>
          <option><value>Missed Collection</value></option>
        </options>
      </dropDown>
    </row>

    <row>
      <dropDown>
        <name>activityStatus</name>
        <udn>activityStatus</udn>
        <caption>#getMessage("specimen_activity_status")</caption>
        <column>ACTIVITY_STATUS</column>
        <options>
          <option><value>Active</value></option>
          <option><value>Closed</value></option>
        </options>
      </dropDown>
    </row>

    <row>
      <textField>
        <name>comments</name>
        <udn>comments</udn>
        <caption>#getMessage("specimen_comments")</caption>
        <column>COMMENTS</column>
      </textField>
    </row>
    
    <row>
      <numberField>
        <name>freezThawCycles</name>
        <udn>freezeThawCycles</udn>
        <caption>#getMessage("specimen_freeze_thaw_cycles")</caption>
        <column>FREEZE_THAW_CYCLES</column>
      </numberField>
    </row>

    <row>
      <subForm>
        <name>specimenPosition</name>
        <udn>specimenPosition</udn>
        <caption>#getMessage("specimen_spec_position")</caption>
        <table>OS_SPECIMEN_POSITIONS_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <primaryKey>SPECIMEN_ID</primaryKey>
        <row>
          <textField>
            <name>containerName</name>
            <udn>containerName</udn>
            <caption>#getMessage("specimen_spec_position_container_name")</caption>
            <column>CONTAINER_NAME</column>
            <recordUrl>#/object-state-params-resolver?stateName=container-detail.locations&amp;objectName=storage_container&amp;key=name&amp;value={{$value}}</recordUrl>
          </textField>              

          <textField>
            <name>positionDimensionTwoString</name>
            <udn>positionDimensionTwoString</udn>
            <caption>#getMessage("specimen_spec_position_container_row")</caption>
            <column>POS_TWO_STR</column>
          </textField>              

          <textField>
            <name>positionDimensionOneString</name>
            <udn>positionDimensionOneString</udn>
            <caption>#getMessage("specimen_spec_position_container_column")</caption>
            <column>POS_ONE_STR</column>
          </textField>

          <textField>
            <name>formattedPos</name>
            <udn>formattedPos</udn>
            <caption>#getMessage("specimen_spec_position_formatted_pos")</caption>
            <column>FORMATTED_POSITION</column>
          </textField>
        </row>
        <row>
          <subForm>
            <name>containerHierarchy</name>
            <udn>containerHierarchy</udn>
            <caption>#getMessage("specimen_spec_position_container_hierarchy")</caption>
            <table>OS_CONTAINER_HIERARCHY_VIEW</table>
            <foreignKey>CONTAINER_ID</foreignKey>
            <parentKey>CONTAINER_IDENTIFIER</parentKey>
            <primaryKey>CONTAINER_ID</primaryKey>
            <row>
              <textField>
                <name>hierarchy</name>
                <udn>hierarchy</udn>
                <caption>#getMessage("specimen_spec_position_container_hierarchy")</caption>
                <column>HIERARCHY</column>
              </textField>
            </row>
          </subForm>
        </row>
    
        <row>
          <subForm>
            <name>ancestors</name>
            <udn>ancestors</udn>
            <caption>#getMessage("specimen_spec_position_container_ancestors")</caption>
            <table>OS_CONTAINER_ANCESTORS_VIEW</table>
            <foreignKey>CONTAINER_ID</foreignKey>
            <parentKey>CONTAINER_IDENTIFIER</parentKey>
            <primaryKey>CONTAINER_ID</primaryKey>
            <row>
              <textField>
                <name>root_container_name</name>
                <udn>root_container_name</udn>
                <caption>#getMessage("specimen_spec_position_container_root_name")</caption>
                <column>FREEZER</column>
                <recordUrl>#/object-state-params-resolver?stateName=container-detail.overview&amp;objectName=storage_container&amp;key=name&amp;value={{$value}}</recordUrl>
              </textField>
            </row>
          </subForm>
        </row>

        <row>
          <subForm>
            <name>allAncestors</name>
            <udn>allAncestors</udn>
            <caption>#getMessage("specimen_spec_position_container_all_ancestors")</caption>
            <table>OS_CONTAINERS_HIERARCHY</table>
            <foreignKey>DESCENDENT_ID</foreignKey>
            <parentKey>CONTAINER_IDENTIFIER</parentKey>
            <pathLink>true</pathLink>
            <row>
              <numberField>
                <name>ancestorId</name>
                <udn>ancestorId</udn>
                <caption>#getMessage("specimen_spec_position_container_ancestor_id")</caption>
                <column>ANCESTOR_ID</column>
              </numberField>
            </row>
          </subForm>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>requirement</name>
        <udn>requirement</udn>
        <caption>#getMessage("specimen_requirement")</caption>
        <table>CATISSUE_CP_REQ_SPECIMEN</table>
        <primaryKey>IDENTIFIER</primaryKey>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>REQ_SPECIMEN_ID</parentKey>
        <row>
          <textField>
            <name>name</name>
            <udn>name</udn>
            <caption>#getMessage("specimen_requirement_name")</caption>
            <column>SPEC_REQ_LABEL</column>
          </textField>
          <textField>
            <name>code</name>
            <udn>code</udn>
            <caption>#getMessage("specimen_requirement_code")</caption>
            <column>CODE</column>
          </textField>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>spmnCollRecvDetails</name>
        <udn>spmnCollRecvDetails</udn>
        <caption>#getMessage("specimen_coll_recv_details")</caption>
        <table>OS_SPMN_COLL_RECV_DETAILS_VIEW</table>
        <primaryKey>SPECIMEN_ID</primaryKey>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <row>
          <dropDown>
            <name>collContainer</name>
            <udn>collContainer</udn>
            <caption>#getMessage("specimen_collection_container")</caption>
            <column>COLL_CONTAINER</column>
            <options>
              <sql>select value from catissue_permissible_value where public_id = 'collection_container' order by value</sql>
            </options>
          </dropDown>
          <dropDown>
            <name>collProcedure</name>
            <udn>collProcedure</udn>
            <caption>#getMessage("specimen_collection_procedure")</caption>
            <column>COLL_PROCEDURE</column>
            <options>
              <sql>select value from catissue_permissible_value where public_id = 'collection_procedure' order by value</sql>
            </options>
          </dropDown>
          <userField>
            <name>collector</name>
            <udn>collector</udn>
            <caption>#getMessage("specimen_collector")</caption>
            <column>COLLECTOR_ID</column>
          </userField>
          <datePicker>
            <name>collTime</name>
            <udn>collTime</udn>
            <caption>#getMessage("specimen_collection_date")</caption>
            <column>COLL_TIME</column>
          </datePicker>
          <dropDown>
            <name>recvQuality</name>
            <udn>recvQuality</udn>
            <caption>#getMessage("specimen_received_quality")</caption>
            <column>RECV_QUALITY</column>
            <options>
              <sql>select value from catissue_permissible_value where public_id = 'receive_quality' order by value</sql>
            </options>
          </dropDown>
          <userField>
            <name>receiver</name>
            <udn>receiver</udn>
            <caption>#getMessage("specimen_receiver")</caption>
            <column>RECEIVER_ID</column>
          </userField>
          <datePicker>
            <name>recvTime</name>
            <udn>recvTime</udn>
            <caption>#getMessage("specimen_received_date")</caption>
            <column>RECV_TIME</column>
          </datePicker>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>specimenStatistics</name>
        <udn>specimenStatistics</udn>
        <caption>#getMessage("specimen_statistics")</caption>
        <table>OS_SPECIMEN_STATS</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <primaryKey>SPECIMEN_ID</primaryKey>
        <row>
          <subForm>
            <name>collector</name>
            <udn>collector</udn>
            <caption>#getMessage("specimen_collector")</caption>
            <table>USER_VIEW</table>
            <foreignKey>IDENTIFIER</foreignKey>
            <parentKey>COLLECTOR_ID</parentKey>
            <row>
              <userField>
                <name>collectorName</name>
                <udn>collectorName</udn>
                <caption>#getMessage("specimen_collector")</caption>
                <column>IDENTIFIER</column>
              </userField>    
            </row>
            <row>
              <siteField>
                <name>primarySite</name>
                <udn>primarySite</udn>
                <caption>#getMessage("specimen_collector_primary_site")</caption>
                <column>PRIMARY_SITE_ID</column>
                <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
              </siteField>
            </row>
            <row>
              <dropDown>
                <name>institute</name>
                <udn>institute</udn>
                <caption>#getMessage("specimen_collector_institute")</caption>
                <column>INSTITUTE_NAME</column>
                <options>
                  <sql>select distinct institute_name from user_view order by institute_name</sql>
                </options>
              </dropDown>
            </row>
          </subForm>
        </row>
        <row>
          <userField>
            <name>receiver</name>
            <udn>receiver</udn>
            <caption>#getMessage("specimen_receiver")</caption>
            <column>RECEIVER_ID</column>
          </userField>    
        </row>
        <row>
          <numberField>
            <name>processingTime</name>
            <udn>processingTime</udn>
            <caption>#getMessage("specimen_processing_time")</caption>
            <column>PROCESSING_TIME</column>
          </numberField>
        </row>
        <row>
          <numberField>
            <name>ischemiaTime</name>
            <udn>ischemiaTime</udn>
            <caption>#getMessage("specimen_ischemia_time")</caption>
            <column>ISCHEMIA_TIME</column>
          </numberField>
        </row>
        <row>
          <numberField>
            <name>aliquotSequence</name>
            <udn>aliquotSequence</udn>
            <caption>#getMessage("specimen_aliquot_sequence")</caption>
            <column>ALIQUOT_SEQ</column>
          </numberField>
        </row>
      </subForm>
    </row>
    
    <row>
      <listBox>
        <name>biohazards</name>
        <udn>biohazards</udn>
        <caption>#getMessage("specimen_biohazard")</caption>
        <multiSelect>true</multiSelect>
        <table>OS_SPECIMEN_BIOHAZARDS</table>
        <column>BIOHAZARD</column>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <options>
          <sql>select value from catissue_permissible_value where public_id = 'specimen_biohazard' order by value</sql>
        </options>
      </listBox>
    </row>

    <row>
      <subForm>
        <name>specimenResv</name>
        <udn>specimenResv</udn>
        <caption>#getMessage("specimen_reservation")</caption>
        <table>OS_SPECIMEN_RESV_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>

        <row>
          <numberField>
            <name>id</name>
            <udn>id</udn>
            <caption>#getMessage("specimen_reservation_id")</caption>
            <column>IDENTIFIER</column>
          </numberField>
        </row>

        <row>
          <dropDown>
            <name>dpShortTitle</name>
            <udn>dpShortTitle</udn>
            <caption>#getMessage("specimen_reservation_dp")</caption>
            <column>DP_SHORT_TITLE</column>
            <options>
              <sql>select short_title from catissue_distribution_protocol where activity_status != 'Disabled' order by short_title</sql>
            </options>
            <recordUrl>#/object-state-params-resolver?stateName=dp-detail.overview&amp;objectName=distribution_protocol&amp;key=shortTitle&amp;value={{$value}}</recordUrl>
          </dropDown>
        </row>

        <row>
          <datePicker>
            <name>resvDate</name>
            <udn>resvDate</udn>
            <caption>#getMessage("specimen_reservation_date")</caption>
            <column>EVENT_TIME</column>
            <format>MM-dd-yyyy</format>
          </datePicker>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>specimenOrders</name>
        <udn>specimenOrders</udn>
        <caption>#getMessage("specimen_order_items_order")</caption>
        <table>OS_SPECIMEN_DISTRIBUTION_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>

        <row>
          <numberField>
            <name>id</name>
            <udn>id</udn>
            <caption>#getMessage("specimen_order_id")</caption>
            <column>ORDER_ID</column>
            <recordUrl>#/orders/{{$value}}/overview</recordUrl>
          </numberField>
        </row>

        <row>
          <textField>
            <name>name</name>
            <udn>name</udn>
            <caption>#getMessage("specimen_distribution_name")</caption>
            <column>NAME</column>
            <recordUrl>#/object-state-params-resolver?stateName=order-detail.overview&amp;objectName=distribution_order&amp;key=name&amp;value={{$value}}</recordUrl>
          </textField>  
        </row>

        <row>
          <subForm>
            <name>dp</name>
            <udn>dp</udn>
            <caption>#getMessage("specimen_order_dp")</caption>
            <table>CATISSUE_DISTRIBUTION_PROTOCOL</table>
            <foreignKey>IDENTIFIER</foreignKey>
            <parentKey>DP_ID</parentKey>

            <row>
              <dropDown>
                <name>shortTitle</name>
                <udn>shortTitle</udn>
                <caption>#getMessage("specimen_order_dp_short_title")</caption>
                <column>SHORT_TITLE</column>
                <options>
                  <sql>select short_title from catissue_distribution_protocol where activity_status != 'Disabled' order by short_title</sql>
                </options>
                <recordUrl>#/object-state-params-resolver?stateName=dp-detail.overview&amp;objectName=distribution_protocol&amp;key=shortTitle&amp;value={{$value}}</recordUrl>
              </dropDown>

              <textField>
                <name>irbId</name>
                <udn>irbId</udn>
                <caption>#getMessage("specimen_order_dp_irb_id")</caption>
                <column>IRB_IDENTIFIER</column>
              </textField>

              <subForm>
                <name>pi</name>
                <udn>pi</udn>
                <caption>#getMessage("specimen_order_dp_pi")</caption>
                <table>USER_VIEW</table>
                <foreignKey>IDENTIFIER</foreignKey>
                <parentKey>PRINCIPAL_INVESTIGATOR_ID</parentKey>
                <row>
                  <userField>
                    <name>investigatorName</name>
                    <udn>investigatorName</udn>
                    <caption>#getMessage("specimen_order_dp_pi_name")</caption>
                    <column>IDENTIFIER</column>
                  </userField>
                </row>

                <row>
                  <textField>
                    <name>email</name>
                    <udn>email</udn>
                    <caption>#getMessage("specimen_order_dp_pi_email")</caption>
                    <column>EMAIL_ADDRESS</column>
                  </textField>
                </row>

                <row>
                  <siteField>
                    <name>primarySite</name>
                    <udn>primarySite</udn>
                    <caption>#getMessage("specimen_order_dp_pi_primary_site")</caption>
                    <column>PRIMARY_SITE_ID</column>
                    <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
                  </siteField>
                </row>

                <row>
                  <dropDown>
                    <name>institute</name>
                    <udn>institute</udn>
                    <caption>#getMessage("specimen_order_dp_pi_institute")</caption>
                    <column>INSTITUTE_NAME</column>
                    <options>
                      <sql>select distinct INSTITUTE_NAME from USER_VIEW</sql>
                    </options>
                  </dropDown>
                </row>
              </subForm>
            </row>
          </subForm>
        </row>

        <row>
          <siteField>
            <name>site</name>
            <udn>site</udn>
            <caption>#getMessage("specimen_order_site")</caption>
            <column>SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
          </siteField>
        </row>

        <row>
          <textField>
            <name>trackingUrl</name>
            <udn>trackingUrl</udn>
            <caption>#getMessage("specimen_order_tracking_url")</caption>
            <column>TRACKING_URL</column>
          </textField>
        </row>

        <row>
          <textField>
            <name>comments</name>
            <udn>comments</udn>
            <caption>#getMessage("specimen_order_comments")</caption>
            <column>COMMENTS</column>
          </textField>
        </row>

        <row>
          <subForm>
            <name>requester</name>
            <udn>requester</udn>
            <caption>#getMessage("specimen_order_requester")</caption>
            <table>USER_VIEW</table>
            <foreignKey>IDENTIFIER</foreignKey>
            <parentKey>REQUESTER_ID</parentKey>
            <row>
              <userField>
                <name>requesterName</name>
                <udn>requesterName</udn>
                <caption>#getMessage("specimen_order_requester_name")</caption>
                <column>IDENTIFIER</column>
              </userField>
            </row>
          </subForm>
        </row>

        <row>
          <datePicker>
            <name>executionDate</name>
            <udn>executionDate</udn>
            <caption>#getMessage("specimen_order_execution_date")</caption>
            <column>EXECUTION_DATE</column>
            <format>MM-dd-yyyy</format>
          </datePicker>
        </row>

        <row>
          <dropDown>
            <name>orderStatus</name>
            <udn>orderStatus</udn>
            <caption>#getMessage("specimen_order_status")</caption>
            <column>ORDER_STATUS</column>
            <options>
              <option><value>EXECUTED</value></option>
              <option><value>PENDING</value></option>
            </options>
          </dropDown>
        </row>

        <row>
          <dropDown>
            <name>status</name>
            <udn>status</udn>
            <caption>#getMessage("specimen_distribution_status")</caption>
            <column>STATUS</column>
            <options>
              <option><value>DISTRIBUTED</value></option>
              <option><value>DISTRIBUTED_AND_CLOSED</value></option>
              <option><value>RETURNED</value></option>
            </options>
          </dropDown>
        </row>

        <row>
          <numberField>
            <name>quantity</name>
            <udn>quantity</udn>
            <caption>#getMessage("specimen_distribution_quantity")</caption>
            <column>QUANTITY</column>
            <noOfDigitsAfterDecimal>2</noOfDigitsAfterDecimal>
          </numberField>
        </row>

        $querySvc.insertCustomQueryForms('order')

        <row>
          <subForm>
            <name>customFields</name>
            <udn>customFields</udn>
            <caption>#getMessage("specimen_order_extensions")</caption>
            <table>OS_ORDERS_CUSTOM_FIELDS_VIEW</table>
            <foreignKey>ORDER_ID</foreignKey>
            <parentKey>ORDER_ID</parentKey>
            <customFieldsInfo>false:OrderExtension:-1</customFieldsInfo>
            <pathLink>true</pathLink>
            <extnFkCol>RECORD_ID</extnFkCol>
          </subForm>
        </row>
      </subForm>
    </row>
    
    <row>
      <subForm>
        <name>specimenShipments</name>
        <udn>specimenShipments</udn>
        <caption>#getMessage("specimen_shipment_items_shipment")</caption>
        <table>OS_SPECIMEN_SHIPMENTS_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <primaryKey>SHIPMENT_ID</primaryKey>

        <row>
          <numberField>
            <name>id</name>
            <udn>id</udn>
            <caption>#getMessage("specimen_shipment_identifier")</caption>
            <column>SHIPMENT_ID</column>
            <recordUrl>#/shipments/{{$value}}/overview</recordUrl>
          </numberField>
        </row>

        <row>
          <textField>
            <name>name</name>
            <udn>name</udn>
            <caption>#getMessage("specimen_shipment_name")</caption>
            <column>SHIPMENT_NAME</column>
            <recordUrl>#/object-state-params-resolver?stateName=shipment-detail.overview&amp;objectName=shipment&amp;key=name&amp;value={{$value}}</recordUrl>
          </textField>
        </row>

        <row>
          <dropDown>
            <name>type</name>
            <udn>type</udn>
            <caption>#getMessage("specimen_shipment_type")</caption>
            <column>SHIPMENT_TYPE</column>
            <options>
              <option><value>SPECIMEN</value></option>
              <option><value>CONTAINER</value></option>
            </options>
          </dropDown>
        </row>

        <row>
          <textField>
            <name>courierName</name>
            <udn>courierName</udn>
            <caption>#getMessage("specimen_shipment_courier_name")</caption>
            <column>COURIER_NAME</column>
          </textField>
        </row>

        <row>
          <textField>
            <name>trackingNumber</name>
            <udn>trackingNumber</udn>
            <caption>#getMessage("specimen_shipment_tracking_number")</caption>
            <column>TRACKING_NUMBER</column>
          </textField>
        </row>

        <row>
          <textField>
            <name>trackingUrl</name>
            <udn>trackingUrl</udn>
            <caption>#getMessage("specimen_shipment_tracking_url")</caption>
            <column>TRACKING_URL</column>
          </textField>
        </row>

        <row>
          <siteField>
            <name>sendingSite</name>
            <udn>sendingSite</udn>
            <caption>#getMessage("specimen_shipment_sending_site")</caption>
            <column>SENDING_SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
          </siteField>
        </row>

        <row>
          <userField>
            <name>sender</name>
            <udn>sender</udn>
            <caption>#getMessage("specimen_shipment_sender")</caption>
            <column>SENDER_ID</column>
          </userField>
        </row>

        <row>
          <datePicker>
            <name>shippedDate</name>
            <udn>shippedDate</udn>
            <caption>#getMessage("specimen_shipment_shipped_date")</caption>
            <column>SHIPPED_DATE</column>
            <format>MM-dd-yyyy</format>
          </datePicker>
        </row>

        <row>
          <textField>
            <name>senderComments</name>
            <udn>senderComments</udn>
            <caption>#getMessage("specimen_shipment_sender_comments")</caption>
            <column>SENDER_COMMENTS</column>
          </textField>
        </row>

        <row>
          <siteField>
            <name>receivingSite</name>
            <udn>receivingSite</udn>
            <caption>#getMessage("specimen_shipment_recv_site")</caption>
            <column>RECEIVING_SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
          </siteField>
        </row>

        <row>
          <userField>
            <name>receiver</name>
            <udn>receiver</udn>
            <caption>#getMessage("specimen_shipment_receiver")</caption>
            <column>RECEIVER_ID</column>
          </userField>
        </row>

        <row>
          <datePicker>
            <name>receivedDate</name>
            <udn>receivedDate</udn>
            <caption>#getMessage("specimen_shipment_received_date")</caption>
            <column>RECEIVED_DATE</column>
            <format>MM-dd-yyyy</format>
          </datePicker>
        </row>

        <row>
          <textField>
            <name>receiverComments</name>
            <udn>receiverComments</udn>
            <caption>#getMessage("specimen_shipment_receiver_comments")</caption>
            <column>RECEIVER_COMMENTS</column>
          </textField>
        </row>

        <row>
          <dropDown>
            <name>receivedQuality</name>
            <udn>receivedQuality</udn>
            <caption>#getMessage("specimen_shipment_recv_quality")</caption>
            <column>RECEIVED_QUALITY</column>
            <options>
              <sql>select value from catissue_permissible_value where public_id = 'shipment_item_receive_quality' order by value</sql>
            </options>
          </dropDown>
        </row>

        <row>
          <dropDown>
            <name>container</name>
            <udn>container</udn>
            <caption>#getMessage("specimen_shipment_container")</caption>
            <column>CONTAINER_NAME</column>
            <options>
              <sql>
                select
                  distinct c.name
                from
                  os_storage_containers c
                  inner join os_shipment_containers sc on sc.container_id = c.identifier
                order by
                  c.name
              </sql>
            </options>
          </dropDown>
        </row>

        <row>
          <dropDown>
            <name>status</name>
            <udn>status</udn>
            <caption>#getMessage("specimen_shipment_status")</caption>
            <column>STATUS</column>
            <options>
              <option><value>Pending</value></option>
              <option><value>Shipped</value></option>
              <option><value>Received</value></option>
            </options>
          </dropDown>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>specimenCarts</name>
        <udn>specimenCarts</udn>
        <caption>#getMessage("specimen_carts")</caption>
        <table>OS_SPECIMEN_CARTS_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <primaryKey>SPECIMEN_ID</primaryKey>

        <row>
          <textField>
            <name>name</name>
            <udn>name</udn>
            <caption>#getMessage("specimen_cart_name")</caption>
            <column>NAME</column>
          </textField>
        </row>

        <row>
          <numberField>
            <name>itemId</name>
            <udn>itemId</udn>
            <caption>#getMessage("specimen_cart_item_id")</caption>
            <column>ITEM_ID</column>
          </numberField>
        </row>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>extensions</name>
        <udn>extensions</udn>
        <caption>#getMessage("specimen_extensions")</caption>
        <table>SPECIMEN_EXTN_RECORDS_VIEW</table>
        <foreignKey>SPECIMEN_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <pathLink>true</pathLink>
        <extnFkCol>RECORD_ID</extnFkCol>
      </subForm>
    </row>

    <row>
      <subForm>
        <name>scg</name>
        <udn>scg</udn>
        <caption>#getMessage("participant_visits")</caption>
        <table>CATISSUE_SPECIMEN_COLL_GROUP</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>SPECIMEN_COLLECTION_GROUP_ID</parentKey>
        <pathLink>true</pathLink>
        <row>
          <subForm>
            <name>participant</name>
            <udn>participant</udn>
            <caption>#getMessage("participant")</caption>
            <table>CPR_VIEW</table>
            <foreignKey>CPR_ID</foreignKey>
            <parentKey>COLLECTION_PROTOCOL_REG_ID</parentKey>
            <pathLink>true</pathLink>
          </subForm>
        </row>
      </subForm>
    </row>
    
    <row>
      <subForm>
        <name>customFields</name>
        <udn>customFields</udn>
        <caption>#getMessage("specimen_field_extensions")</caption>
        <table>OS_SPEC_CUST_FIELD_EXTNS_VIEW</table>
        <foreignKey>SPEC_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <pathLink>true</pathLink>
        <extnFkCol>RECORD_ID</extnFkCol>
      </subForm>
    </row>

    $querySvc.insertCustomQueryForms('specimen')
  </view>
</form>
